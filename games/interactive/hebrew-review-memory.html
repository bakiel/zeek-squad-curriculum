<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hebrew Memory Game - Zeek Squad</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #1E40AF 0%, #1E3A8A 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        .container { max-width: 600px; margin: 0 auto; }
        .header { text-align: center; color: white; margin-bottom: 20px; }
        .header h1 { font-size: 1.8rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .header .standard { font-size: 0.75rem; opacity: 0.85; margin-top: 4px; }
        .back-btn { display: inline-block; background: rgba(255,255,255,0.2); color: white; text-decoration: none; padding: 8px 20px; border-radius: 20px; font-size: 0.9rem; margin-bottom: 15px; transition: all 0.3s; cursor: pointer; }
        .back-btn:hover { background: rgba(255,255,255,0.3); }
        .mascot { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
        .mascot-emoji { font-size: 4rem; animation: bounce 1s ease-in-out infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .speech-bubble { background: white; padding: 15px 20px; border-radius: 20px; flex: 1; position: relative; font-size: 1.05rem; color: #333; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .speech-bubble:before { content: ''; position: absolute; left: -10px; top: 50%; transform: translateY(-50%); border: 10px solid transparent; border-right-color: white; }
        .progress-container { background: rgba(255,255,255,0.3); border-radius: 10px; height: 12px; margin: 15px 0; overflow: hidden; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, #FFD700, #FFA500); border-radius: 10px; transition: width 0.5s ease; width: 0%; }
        .stars { text-align: center; font-size: 2rem; margin-bottom: 15px; }
        .star { color: rgba(255,255,255,0.3); transition: all 0.5s; display: inline-block; }
        .star.earned { color: #FFD700; animation: starEarn 0.6s ease; filter: drop-shadow(0 0 10px #FFD700); }
        @keyframes starEarn { 0% { transform: scale(0) rotate(-180deg); } 60% { transform: scale(1.5) rotate(20deg); } 100% { transform: scale(1) rotate(0deg); } }
        .tab-nav { display: flex; gap: 5px; margin-bottom: 15px; flex-wrap: wrap; justify-content: center; }
        .tab-btn { padding: 10px 16px; border: none; background: rgba(255,255,255,0.2); color: white; border-radius: 10px; font-size: 0.9rem; cursor: pointer; transition: all 0.3s; font-family: inherit; }
        .tab-btn:hover { background: rgba(255,255,255,0.3); }
        .tab-btn.active { background: white; color: #1E40AF; font-weight: bold; }
        .tab-btn.completed::after { content: ' \2713'; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .game-area { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .instruction { background: linear-gradient(135deg, #1E40AF 0%, #1E3A8A 100%); color: white; padding: 15px 20px; border-radius: 15px; text-align: center; margin-bottom: 20px; font-size: 1.1rem; }

        .learn-letter { background: #eff6ff; border-radius: 20px; padding: 20px; margin: 12px 0; text-align: center; border: 3px solid #bfdbfe; cursor: pointer; transition: all 0.3s; }
        .learn-letter:hover { transform: scale(1.03); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .learn-letter .big { font-size: 4rem; font-weight: bold; color: #1e3a8a; }
        .learn-letter .name { font-size: 1.3rem; font-weight: bold; color: #3b82f6; margin-top: 5px; }
        .learn-letter .sound { font-size: 0.95rem; color: #6366f1; }

        .memory-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin: 20px 0; }
        .memory-card { aspect-ratio: 1; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: bold; cursor: pointer; transition: all 0.3s; border: 3px solid #bfdbfe; user-select: none; }
        .memory-card.hidden-card { background: linear-gradient(135deg, #1E40AF 0%, #3b82f6 100%); color: transparent; }
        .memory-card.revealed { background: #eff6ff; color: #1e3a8a; }
        .memory-card.matched { background: #dcfce7; border-color: #22c55e; color: #15803d; pointer-events: none; }
        .memory-card.wrong-flip { background: #fee2e2; border-color: #ef4444; }
        .memory-stats { display: flex; justify-content: center; gap: 20px; margin: 15px 0; }
        .memory-stat { text-align: center; }
        .memory-stat .val { font-size: 1.5rem; font-weight: bold; color: #1e40af; }
        .memory-stat .label { font-size: 0.8rem; color: #666; }
        .q-mark { color: white; font-size: 2.5rem; }

        .flip-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 20px 0; }
        .flip-card { background: #eff6ff; border-radius: 15px; padding: 20px; text-align: center; border: 3px solid #bfdbfe; cursor: pointer; transition: all 0.3s; min-height: 80px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; color: #1e3a8a; }
        .flip-card:hover { border-color: #3b82f6; transform: scale(1.03); }
        .flip-card.correct { background: #dcfce7; border-color: #22c55e; color: #15803d; }
        .flip-card.wrong { background: #fee2e2; border-color: #ef4444; color: #dc2626; }

        .next-btn { display: block; width: 100%; padding: 15px; background: linear-gradient(135deg, #1E40AF 0%, #1E3A8A 100%); color: white; border: none; border-radius: 10px; font-size: 1.2rem; cursor: pointer; font-family: inherit; margin-top: 15px; transition: all 0.3s; }
        .next-btn:hover { transform: scale(1.02); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .learn-card { background: #eff6ff; border-radius: 15px; padding: 20px; margin: 15px 0; text-align: center; border: 2px solid #bfdbfe; }
        .learn-card h3 { color: #1e3a8a; margin-bottom: 10px; }
        .feedback { text-align: center; padding: 10px; margin: 10px 0; border-radius: 10px; font-weight: bold; font-size: 1.1rem; }
        .feedback.correct { background: #dcfce7; color: #15803d; }
        .feedback.wrong { background: #fee2e2; color: #dc2626; }
        .round-indicator { display: flex; justify-content: center; gap: 8px; margin-bottom: 15px; }
        .round-dot { width: 12px; height: 12px; border-radius: 50%; background: #e0e0e0; transition: all 0.3s; }
        .round-dot.active { background: #1E40AF; transform: scale(1.2); }
        .round-dot.completed { background: #FFD700; }
        .celebration { display: none; text-align: center; padding: 30px; }
        .celebration.show { display: block; animation: celebrationPop 0.5s ease; }
        @keyframes celebrationPop { 0% { transform: scale(0); } 60% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .celebration h2 { font-size: 2rem; color: #1e3a8a; margin-bottom: 15px; }
        .celebration .trophy { font-size: 5rem; margin-bottom: 15px; display: block; }
        .confetti { position: fixed; top: -10px; font-size: 1.5rem; animation: fall linear forwards; pointer-events: none; z-index: 1000; }
        @keyframes fall { to { transform: translateY(110vh) rotate(720deg); opacity: 0; } }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-btn">Back to Games</a>
        <div class="header">
            <h1>Hebrew Memory Game</h1>
            <div class="standard">Hebrew Literacy</div>
        </div>
        <div class="mascot">
            <div class="mascot-emoji">&#129504;</div>
            <div class="speech-bubble" id="mascotSpeech">
                Let us test your memory! Match each Hebrew letter to its name!
            </div>
        </div>
        <div class="stars">
            <span class="star" id="star1">&#9733;</span>
            <span class="star" id="star2">&#9733;</span>
            <span class="star" id="star3">&#9733;</span>
            <span class="star" id="star4">&#9733;</span>
            <span class="star" id="star5">&#9733;</span>
        </div>
        <div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
        <div class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('learn')" id="tabLearn">Learn</button>
            <button class="tab-btn" onclick="switchTab('practice')" id="tabPractice">Memory</button>
            <button class="tab-btn" onclick="switchTab('quiz')" id="tabQuiz">Match</button>
        </div>

        <div class="tab-content active" id="learnTab">
            <div class="game-area">
                <div class="instruction">Review the 3 Hebrew letters and their names!</div>
                <div id="learnContent"></div>
                <button class="next-btn" onclick="switchTab('practice')">Play Memory Game!</button>
            </div>
        </div>

        <div class="tab-content" id="practiceTab">
            <div class="game-area">
                <div class="instruction">Flip cards to find matching pairs!</div>
                <div class="memory-stats">
                    <div class="memory-stat"><div class="val" id="movesCount">0</div><div class="label">Moves</div></div>
                    <div class="memory-stat"><div class="val" id="pairsCount">0/3</div><div class="label">Pairs</div></div>
                </div>
                <div class="memory-grid" id="memoryGrid"></div>
                <div id="memoryFeedback"></div>
                <button class="next-btn" id="memoryRestart" onclick="initMemory()" style="display:none">Play Again!</button>
            </div>
        </div>

        <div class="tab-content" id="quizTab">
            <div class="game-area">
                <div class="instruction">Match each letter to its name!</div>
                <div class="round-indicator" id="quizRounds"></div>
                <div id="quizContent"></div>
            </div>
        </div>

        <div class="celebration" id="celebration">
            <span class="trophy">&#127942;</span>
            <h2>Memory Master!</h2>
            <p>You matched all the Hebrew letters to their names!</p>
            <button class="next-btn" onclick="location.reload()">Play Again!</button>
        </div>
    </div>

    <script>
        var audioBase = '../../assets/audio/week4/';
        var currentAudio = null;
        function playAudio(key) {
            if (currentAudio) { currentAudio.pause(); currentAudio.currentTime = 0; }
            currentAudio = new Audio(audioBase + key + '.mp3');
            currentAudio.play().catch(function(){});
        }

        var hebrewLetters = [
            { letter: '\u05D0', name: 'Aleph', sound: 'Silent (glottal stop)' },
            { letter: '\u05D1\u05BC', name: 'Bet', sound: 'B sound' },
            { letter: '\u05D1', name: 'Vet', sound: 'V sound' }
        ];

        var score = 0;
        var totalPoints = 20;
        var tabsCompleted = {};
        var quizRound = 0;
        var quizTotal = 3;

        function updateProgress() {
            var pct = Math.min(100, Math.round((score / totalPoints) * 100));
            document.getElementById('progressBar').style.width = pct + '%';
            var starsEarned = Math.floor(pct / 20);
            for (var i = 1; i <= 5; i++) {
                var el = document.getElementById('star' + i);
                if (i <= starsEarned && !el.classList.contains('earned')) {
                    el.classList.add('earned');
                    playAudio('star');
                }
            }
            if (pct >= 100) { setTimeout(showCelebration, 800); }
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(function(t) { t.classList.remove('active'); });
            document.querySelectorAll('.tab-btn').forEach(function(b) { b.classList.remove('active'); });
            document.getElementById(tab + 'Tab').classList.add('active');
            document.getElementById('tab' + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add('active');
        }

        function shuffle(arr) {
            var a = arr.slice();
            for (var i = a.length - 1; i > 0; i--) {
                var j = Math.floor(Math.random() * (i + 1));
                var t = a[i]; a[i] = a[j]; a[j] = t;
            }
            return a;
        }

        function buildLearn() {
            var container = document.getElementById('learnContent');
            container.textContent = '';
            hebrewLetters.forEach(function(h) {
                var card = document.createElement('div');
                card.className = 'learn-letter';
                var big = document.createElement('div');
                big.className = 'big';
                big.textContent = h.letter;
                var name = document.createElement('div');
                name.className = 'name';
                name.textContent = h.name;
                var sound = document.createElement('div');
                sound.className = 'sound';
                sound.textContent = h.sound;
                card.appendChild(big);
                card.appendChild(name);
                card.appendChild(sound);
                card.addEventListener('click', function() {
                    document.getElementById('mascotSpeech').textContent = h.name + ' - ' + h.sound + '!';
                    playAudio('hebmem-intro');
                });
                container.appendChild(card);
            });
            if (!tabsCompleted.learn) {
                tabsCompleted.learn = true;
                score += 4;
                updateProgress();
                document.getElementById('tabLearn').classList.add('completed');
            }
        }

        var memoryCards = [];
        var flippedCards = [];
        var matchedPairs = 0;
        var moves = 0;
        var memoryLocked = false;

        function initMemory() {
            matchedPairs = 0;
            moves = 0;
            flippedCards = [];
            memoryLocked = false;
            document.getElementById('movesCount').textContent = '0';
            document.getElementById('pairsCount').textContent = '0/3';
            document.getElementById('memoryRestart').style.display = 'none';
            document.getElementById('memoryFeedback').textContent = '';

            memoryCards = [];
            hebrewLetters.forEach(function(h) {
                memoryCards.push({ display: h.letter, matchId: h.name, type: 'letter' });
                memoryCards.push({ display: h.name, matchId: h.name, type: 'name' });
            });
            memoryCards = shuffle(memoryCards);

            var grid = document.getElementById('memoryGrid');
            grid.textContent = '';
            memoryCards.forEach(function(mc, idx) {
                var card = document.createElement('div');
                card.className = 'memory-card hidden-card';
                card.dataset.idx = idx;
                var qm = document.createElement('span');
                qm.className = 'q-mark';
                qm.textContent = '?';
                card.appendChild(qm);
                card.addEventListener('click', function() { flipCard(card, idx); });
                grid.appendChild(card);
            });
        }

        function flipCard(cardEl, idx) {
            if (memoryLocked) return;
            if (cardEl.classList.contains('revealed') || cardEl.classList.contains('matched')) return;
            if (flippedCards.length >= 2) return;

            cardEl.classList.remove('hidden-card');
            cardEl.classList.add('revealed');
            cardEl.textContent = memoryCards[idx].display;

            flippedCards.push({ el: cardEl, data: memoryCards[idx] });

            if (flippedCards.length === 2) {
                moves++;
                document.getElementById('movesCount').textContent = moves;
                memoryLocked = true;

                var first = flippedCards[0];
                var second = flippedCards[1];

                if (first.data.matchId === second.data.matchId && first.data.type !== second.data.type) {
                    first.el.classList.add('matched');
                    second.el.classList.add('matched');
                    matchedPairs++;
                    document.getElementById('pairsCount').textContent = matchedPairs + '/3';
                    score += 3;
                    updateProgress();
                    document.getElementById('mascotSpeech').textContent = 'Match! ' + first.data.matchId + '!';
                    playAudio('hebmem-correct');
                    flippedCards = [];
                    memoryLocked = false;

                    if (matchedPairs === 3) {
                        tabsCompleted.practice = true;
                        document.getElementById('tabPractice').classList.add('completed');
                        var fb = document.getElementById('memoryFeedback');
                        fb.textContent = '';
                        var div = document.createElement('div');
                        div.className = 'feedback correct';
                        div.textContent = 'All pairs found in ' + moves + ' moves!';
                        fb.appendChild(div);
                        document.getElementById('memoryRestart').style.display = 'block';
                        playAudio('hebmem-complete');
                    }
                } else {
                    first.el.classList.add('wrong-flip');
                    second.el.classList.add('wrong-flip');
                    playAudio('hebmem-wrong');
                    setTimeout(function() {
                        first.el.classList.remove('revealed', 'wrong-flip');
                        first.el.classList.add('hidden-card');
                        first.el.textContent = '';
                        var qm1 = document.createElement('span');
                        qm1.className = 'q-mark';
                        qm1.textContent = '?';
                        first.el.appendChild(qm1);
                        second.el.classList.remove('revealed', 'wrong-flip');
                        second.el.classList.add('hidden-card');
                        second.el.textContent = '';
                        var qm2 = document.createElement('span');
                        qm2.className = 'q-mark';
                        qm2.textContent = '?';
                        second.el.appendChild(qm2);
                        flippedCards = [];
                        memoryLocked = false;
                    }, 1000);
                }
            }
        }

        function initQuiz() {
            quizRound = 0;
            var dots = document.getElementById('quizRounds');
            dots.textContent = '';
            for (var i = 0; i < quizTotal; i++) {
                var dot = document.createElement('div');
                dot.className = 'round-dot';
                dot.id = 'qDot' + i;
                dots.appendChild(dot);
            }
            showQuizRound();
        }

        function showQuizRound() {
            var content = document.getElementById('quizContent');
            if (quizRound >= quizTotal) {
                tabsCompleted.quiz = true;
                document.getElementById('tabQuiz').classList.add('completed');
                content.textContent = '';
                var card = document.createElement('div');
                card.className = 'learn-card';
                var h3 = document.createElement('h3');
                h3.textContent = 'Matching Complete!';
                var p = document.createElement('p');
                p.textContent = 'You matched all Hebrew letters to their names!';
                card.appendChild(h3);
                card.appendChild(p);
                content.appendChild(card);
                playAudio('hebmem-complete');
                score += 2;
                updateProgress();
                return;
            }
            document.getElementById('qDot' + quizRound).classList.add('active');
            var pair = hebrewLetters[quizRound];

            content.textContent = '';
            var counter = document.createElement('p');
            counter.style.textAlign = 'center';
            counter.style.color = '#666';
            counter.textContent = 'Match ' + (quizRound + 1) + ' of ' + quizTotal;
            content.appendChild(counter);

            var letterDisplay = document.createElement('div');
            letterDisplay.style.textAlign = 'center';
            letterDisplay.style.fontSize = '5rem';
            letterDisplay.style.fontWeight = 'bold';
            letterDisplay.style.color = '#1e3a8a';
            letterDisplay.style.margin = '20px 0';
            letterDisplay.style.background = '#eff6ff';
            letterDisplay.style.borderRadius = '20px';
            letterDisplay.style.padding = '20px';
            letterDisplay.textContent = pair.letter;
            content.appendChild(letterDisplay);

            var prompt = document.createElement('p');
            prompt.style.textAlign = 'center';
            prompt.style.fontWeight = 'bold';
            prompt.style.margin = '10px 0';
            prompt.textContent = 'What is this letter called?';
            content.appendChild(prompt);

            var names = shuffle(['Aleph', 'Bet', 'Vet']);
            var grid = document.createElement('div');
            grid.className = 'flip-grid';
            names.forEach(function(n) {
                var cardEl = document.createElement('div');
                cardEl.className = 'flip-card';
                cardEl.textContent = n;
                cardEl.addEventListener('click', function() { checkFlipQuiz(cardEl, n, pair.name); });
                grid.appendChild(cardEl);
            });
            content.appendChild(grid);
        }

        function checkFlipQuiz(cardEl, chosen, correct) {
            var cards = document.querySelectorAll('#quizContent .flip-card');
            cards.forEach(function(c) { var cl = c.cloneNode(true); c.parentNode.replaceChild(cl, c); });
            if (chosen === correct) {
                cardEl.classList.add('correct');
                score += 1;
                document.getElementById('qDot' + quizRound).classList.remove('active');
                document.getElementById('qDot' + quizRound).classList.add('completed');
                document.getElementById('mascotSpeech').textContent = 'Yes! That is ' + correct + '!';
                playAudio('hebmem-correct');
            } else {
                cardEl.classList.add('wrong');
                document.querySelectorAll('#quizContent .flip-card').forEach(function(c) {
                    if (c.textContent === correct) c.classList.add('correct');
                });
                document.getElementById('mascotSpeech').textContent = 'That letter is called ' + correct + '!';
                playAudio('hebmem-wrong');
            }
            updateProgress();
            quizRound++;
            setTimeout(showQuizRound, 1200);
        }

        function showCelebration() {
            document.getElementById('celebration').classList.add('show');
            playAudio('hebmem-complete');
            for (var i = 0; i < 30; i++) {
                setTimeout(function() {
                    var c = document.createElement('div');
                    c.className = 'confetti';
                    c.textContent = ['\u05D0','\u05D1','+','*'][Math.floor(Math.random()*4)];
                    c.style.left = Math.random() * 100 + 'vw';
                    c.style.animationDuration = (2 + Math.random() * 3) + 's';
                    c.style.color = ['#FFD700','#1E40AF','#6366f1','#3b82f6'][Math.floor(Math.random()*4)];
                    document.body.appendChild(c);
                    setTimeout(function() { c.remove(); }, 5000);
                }, i * 100);
            }
        }

        buildLearn();
        initMemory();
        initQuiz();
        playAudio('hebmem-intro');
    </script>
</body>
</html>
